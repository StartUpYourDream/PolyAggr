import { create } from 'zustand'
import { persist } from 'zustand/middleware'

export type Locale = 'zh' | 'en'

interface I18nState {
  locale: Locale
  setLocale: (locale: Locale) => void
}

export const useI18n = create<I18nState>()(
  persist(
    (set) => ({
      locale: 'zh',
      setLocale: (locale) => set({ locale }),
    }),
    {
      name: 'locale-storage',
    }
  )
)

// Translation function
export function t(key: string): string {
  const { locale } = useI18n.getState()
  const translations = locale === 'zh' ? zhTranslations : enTranslations

  const keys = key.split('.')
  let value: any = translations

  for (const k of keys) {
    value = value?.[k]
    if (value === undefined) {
      console.warn(`Translation key not found: ${key}`)
      return key
    }
  }

  return value as string
}

// Hook for reactive translations
export function useTranslation() {
  const { locale } = useI18n()
  return {
    t: (key: string) => {
      const translations = locale === 'zh' ? zhTranslations : enTranslations
      const keys = key.split('.')
      let value: any = translations

      for (const k of keys) {
        value = value?.[k]
        if (value === undefined) {
          console.warn(`Translation key not found: ${key}`)
          return key
        }
      }

      return value as string
    },
    locale,
  }
}

// Chinese translations
const zhTranslations = {
  common: {
    loading: '加载中...',
    error: '错误',
    noData: '暂无数据',
    search: '搜索',
    all: '所有',
    active: '活跃',
    closed: '已关闭',
    other: '其他',
    recentSearches: '最近搜索',
    clear: '清空',
  },
  nav: {
    trending: '热门',
    leaderboard: '排行榜',
    dashboard: '数据看板',
    portfolio: '我的持仓',
    search: '搜索',
    userDetail: '用户详情',
  },
  market: {
    notFound: '市场未找到',
    notFoundDesc: '您查找的市场不存在',
    endDate: '结束于',
    endTime: '事件结束倒计时',
    status: '事件状态',
    statusActive: '进行中',
    statusEnded: '已结束',
    statusDisputed: '争议讨论中',
    statusReview: '审核中',
    subEvent: '子事件',
    subEvents: '子事件',
    allSubEvents: '所有子事件',
    historyEvents: '过往事件下拉选择框',
    orderBook: '订单簿',
    yesOrderBook: 'YES 订单簿',
    noOrderBookTitle: 'NO 订单簿',
    drawOrderBook: 'DRAW 订单簿',
    noOrderBook: '暂无订单簿数据',
    noPriceData: '暂无价格数据',
    tradeOn: '在 Polymarket 交易',
    description: '事件说明',
    descriptionPlaceholder: '事件说明详情,说明该事件具体是预测什么?',
    dataOverview: '数据概览',
    yesData: 'Yes 数据',
    noData: 'No 数据',
    drawData: 'Draw 数据',
  },
  eventDetail: {
    priceChart: '价格走势',
    orderBook: '订单簿',
    marketStats: '市场数据',

    // 数据概览 - 12个核心指标
    totalOpenInterest: '总持仓',
    volume24h: '24h成交额',
    turnoverRate: '换手率',
    activeTraders: '活跃地址',
    newTraders: '新增地址',
    avgSpread: '平均价差',
    volatility: '波动率',
    whaleConcentration: '持仓集中度',
    liquidityConcentration: '流动性集中度',
    lateVolumeSpike: '临期异动',
    disputeRisk: '争议风险',
    creditScore: '信用评分',

    // YES/NO 单腿数据 - 16个指标
    price: '当前价格',
    priceChange1h: '1h变化',
    priceChange24h: '24h变化',
    outcomeVolume24h: '单腿成交额',
    outcomeOI: '单腿持仓',
    legTurnoverRate: '单腿换手',
    bidDepth: '买盘深度',
    askDepth: '卖盘深度',
    depthSkew: '深度偏斜',
    liquidityGap: '流动性缺口',
    liquidityWalls: '流动性墙',
    vwapDeviation: '均价偏离',
    smartMoneyRatio: '聪明钱占比',
    whaleRatio: '鲸鱼占比',
    manipulationRisk: '操纵风险',
    legConfidence: '可信度',

    tradeOnPolymarket: '在 Polymarket 交易',

    // 数据项提示说明
    tooltips: {
      totalOpenInterest: '事件所有方向的总持仓量',
      volume24h: '过去24小时的总交易金额',
      turnoverRate: '24h成交额/总持仓,反映市场活跃度',
      activeTraders: '24h内有交易活动的地址数',
      newTraders: '24h内首次参与该市场的新地址数',
      avgSpread: '买一卖一价格差的平均值,反映流动性',
      volatility: '价格波动的标准差,反映市场不确定性',
      whaleConcentration: '大户持仓占比,反映市场集中度',
      liquidityConcentration: '做市商流动性集中程度',
      lateVolumeSpike: '临近结算时的异常交易量',
      disputeRisk: '基于历史数据的结算争议可能性',
      creditScore: '综合评估该事件的质量评分',

      price: '当前该方向的价格',
      priceChange1h: '过去1小时的价格变化',
      priceChange24h: '过去24小时的价格变化',
      outcomeVolume24h: '该单腿24h的成交金额',
      outcomeOI: '该单腿的持仓量',
      legTurnoverRate: '该单腿的换手率',
      bidDepth: '买盘订单簿前10档深度',
      askDepth: '卖盘订单簿前10档深度',
      depthSkew: '买卖深度差异,正值表示买盘强',
      liquidityGap: '订单簿中的流动性真空区域',
      liquidityWalls: '大额挂单形成的流动性障碍',
      vwapDeviation: '当前价与成交均价的偏离度',
      smartMoneyRatio: '专业交易者的参与比例',
      whaleRatio: '大户交易占该腿的比例',
      manipulationRisk: '该方向被操纵的风险评分',
      legConfidence: '该方向数据可信度评分',
    },

    tabs: {
      holders: '持仓者',
      topTraders: '顶级交易者',
      activity: '活动记录',
    },

    table: {
      address: '地址',
      shares: '份额',
      value: '价值',
      avgBuy: '买入均价',
      avgSell: '卖出均价',
      realizedPnL: '已实现盈亏',
      unrealizedPnL: '未实现盈亏',
      time: '时间',
      type: '类型',
      price: '价格',
      total: '总计',
      txHash: '交易哈希',
    },
  },
  orderBook: {
    latestPrice: '最新价格',
    spread: '价差',
  },
  stats: {
    volume24h: '24h交易量',
    openInterest: '持仓量',
    bidDepth: '买盘深度',
    askDepth: '卖盘深度',
    depthSkew: '深度偏斜',
    priceChange24h: '24h涨跌',
    yesPrice: 'Yes 价格',
    noPrice: 'No 价格',
  },
  tabs: {
    activity: '交易记录',
    holders: '持仓者',
    traders: '顶级交易者',
  },
  table: {
    address: '地址',
    shares: '份额',
    value: '价值',
    avgBuyPrice: '买入均价',
    avgSellPrice: '卖出均价',
    realizedPnl: '已实现盈亏',
    realizedRoi: '已实现回报率',
    unrealizedPnl: '未实现盈亏',
    unrealizedRoi: '未实现回报率',
    time: '时间',
    type: '类型',
    price: '价格',
    total: '总计',
    txHash: '交易哈希',
    buy: '买入',
    sell: '卖出',
    yes: '是',
    no: '否',
    eventName: '事件名称',
    endDate: '结束日期',
    countdown: '倒计时',
    firstTrade: '首次交易',
    status: '状态',
    buyCount: '买入次数',
    sellCount: '卖出次数',
    active: '活跃',
    closed: '已关闭',
    settled: '已结算',
    holdingDays: '持仓天数',
    days: '天',
  },
  user: {
    profile: '用户概览',
    totalProfit: '总盈亏',
    totalVolume: '总交易量',
    activePositions: '活跃持仓',
    winRate: '胜率',
    profitChart: '盈亏趋势',
    radarChart: '交易能力分析',
    positions: '持仓',
    history: '交易历史',
    analytics: '分析',
    profitability: '盈利能力',
    activeness: '活跃度',
    diversification: '多样化',
    riskManagement: '风险管理',
    timing: '时机把握',
    consistency: '稳定性',
    notFound: '未找到用户',
    notFoundDesc: '您查找的用户资料不存在',
    usdcBalance: 'USDC 余额',
    pnl: '盈亏',
    categoryAnalysis: '类别分析',
    behaviorAnalysis: '行为分析',
    riskPreference: '风险偏好',
    beliefAnalysis: '信念偏好',
    smartMoney: '聪明钱',
    trendFollower: '趋势跟随者',
    contrarian: '逆向交易者',
    noiseTrader: '噪音交易者',
    crypto: '加密货币',
    politics: '政治',
    sports: '体育',
    entertainment: '娱乐',
    finance: '金融',
    highRisk: '高风险',
    mediumRisk: '中等风险',
    lowRisk: '低风险',
    conservative: '保守型',
    longTerm: '长期',
    shortTerm: '短期',
    momentum: '动量',
    valueInvesting: '价值',
    holdings: '持仓',
    tradeHistory: '交易历史',
    activityLog: '活动记录',
    aiSummary: 'AI 总结',
    aiDescription: '该地址展现出典型的聪明钱特征，擅长在市场趋势早期介入。交易行为偏向高风险高回报策略，主要活跃于加密货币和政治类预测市场。持仓周期较短，属于短期交易者，具有较强的市场敏感度和执行力。整体风险偏好激进，但盈利能力突出。',
    pnlDistribution: '盈亏占比',
    marketsParticipated: '参与市场数',
    totalTrades: '总交易次数',
    totalVolumeStat: '总成交量',
    avgTradePrice: '平均成交价',
    avgHoldingTime: '平均持仓时间',
    maxProfit: '历史最赚钱单笔盈利',
    maxLoss: '历史最亏钱单笔亏损',
    minutesAgo: '分钟前',
  },
  timeRange: {
    '1d': '1天',
    '1w': '1周',
    '1m': '1月',
    '3m': '3月',
    '1y': '1年',
    all: '全部',
  },
  trending: {
    title: '热门市场',
    description: '来自 Polymarket 的实时预测市场数据',
    markets: '个市场',
    category: '分类',
    event: '事件',
    yes: '是',
    no: '否',
    oiChange: '持仓变化',
    change1h: '1h',
    change24h: '24h',
    endsAt: '结束于',
    loadingMarkets: '加载市场中...',
    loadError: '加载市场失败',
    unknownError: '未知错误',
    noMarketsFound: '该分类下未找到市场',
  },
  search: {
    searchResults: '搜索结果',
    resultsFor: '的搜索结果',
    enterKeyword: '请输入搜索关键词',
    events: '事件',
    searching: '搜索中...',
    results: '个结果',
    noEventsFound: '未找到与',
    matching: '匹配的事件',
    users: '用户',
    noUsersFound: '未找到用户',
    balance: '余额',
    roi: '回报率',
    tip: '提示:',
    tipMessage: '输入以 "0x" 开头的钱包地址可以搜索用户',
    startSearching: '开始搜索',
    searchDescription: '使用上方搜索栏查找预测市场或用户资料。您可以按事件名称、关键词或钱包地址搜索。',
  },
  leaderboard: {
    title: '用户排行榜',
    subtitle: '根据投资回报率和交易表现排名的顶级交易者',
    rank: '排名',
    address: '地址',
    balance: '余额',
    portfolioValue: '持仓价值',
    pnl7d: '7日盈亏',
    pnl30d: '30日盈亏',
    pnlTotal: '总盈亏',
    winRate: '胜率',
    buyCount: '买入',
    sellCount: '卖出',
  },
  dashboard: {
    title: '数据看板',
    subtitle: '预测市场平台的关键指标和趋势分析',
    platform: {
      all: '所有平台',
      polymarket: 'Polymarket',
      kalshi: 'Kalshi',
      manifold: 'Manifold',
    },
    kpi: {
      totalVolume: '总交易量',
      volume24h: '24h交易量',
      totalUsers: '总用户数',
      activeUsers: '活跃用户',
      totalMarkets: '总市场数',
      activeMarkets: '活跃市场',
    },
    charts: {
      volumeTrend: '交易量趋势',
      userGrowth: '用户增长',
      eventStatus: '事件状态分布',
      categoryDistribution: '分类分布',
      tradingHeatmap: '交易热力图',
      topMarkets: '热门市场',
      avgReturnTrend: '平均回报率趋势',
      newMarketsTrend: '新增市场趋势',
      liquidityDistribution: '流动性分布',
      volumeByCategory: '分类交易量',
    },
  },
}

// English translations
const enTranslations = {
  common: {
    loading: 'Loading...',
    error: 'Error',
    noData: 'No data',
    search: 'Search',
    all: 'All',
    active: 'Active',
    closed: 'Closed',
    other: 'Other',
    recentSearches: 'Recent Searches',
    clear: 'Clear',
  },
  nav: {
    trending: 'Trending',
    leaderboard: 'Leaderboard',
    dashboard: 'Dashboard',
    portfolio: 'Portfolio',
    search: 'Search',
    userDetail: 'User Profile',
  },
  market: {
    notFound: 'Market Not Found',
    notFoundDesc: 'The market you are looking for does not exist',
    endDate: 'Ends at',
    endTime: 'Event Countdown',
    status: 'Event Status',
    statusActive: 'Active',
    statusEnded: 'Ended',
    statusDisputed: 'Disputed',
    statusReview: 'Under Review',
    subEvent: 'Sub-event',
    subEvents: 'Sub-events',
    allSubEvents: 'All Sub-events',
    historyEvents: 'Historical Events Selector',
    orderBook: 'Order Book',
    yesOrderBook: 'YES Order Book',
    noOrderBookTitle: 'NO Order Book',
    drawOrderBook: 'DRAW Order Book',
    noOrderBook: 'No order book data',
    noPriceData: 'No price data',
    tradeOn: 'Trade on Polymarket',
    description: 'Event Description',
    descriptionPlaceholder: 'Detailed event description explaining what is being predicted',
    dataOverview: 'Data Overview',
    yesData: 'Yes Data',
    noData: 'No Data',
    drawData: 'Draw Data',
  },
  eventDetail: {
    priceChart: 'Price Chart',
    orderBook: 'Order Book',
    marketStats: 'Market Stats',

    // Data Overview - 12 core indicators
    totalOpenInterest: 'Total Open Interest',
    volume24h: '24h Volume',
    turnoverRate: 'Turnover Rate',
    activeTraders: 'Active Traders',
    newTraders: 'New Traders',
    avgSpread: 'Avg Spread',
    volatility: 'Volatility',
    whaleConcentration: 'Whale Concentration',
    liquidityConcentration: 'Liquidity Concentration',
    lateVolumeSpike: 'Late Volume Spike',
    disputeRisk: 'Dispute Risk',
    creditScore: 'Credit Score',

    // YES/NO leg data - 16 indicators
    price: 'Current Price',
    priceChange1h: '1h Change',
    priceChange24h: '24h Change',
    outcomeVolume24h: 'Outcome Volume',
    outcomeOI: 'Outcome OI',
    legTurnoverRate: 'Leg Turnover',
    bidDepth: 'Bid Depth',
    askDepth: 'Ask Depth',
    depthSkew: 'Depth Skew',
    liquidityGap: 'Liquidity Gap',
    liquidityWalls: 'Liquidity Walls',
    vwapDeviation: 'VWAP Deviation',
    smartMoneyRatio: 'Smart Money Ratio',
    whaleRatio: 'Whale Ratio',
    manipulationRisk: 'Manipulation Risk',
    legConfidence: 'Leg Confidence',

    tradeOnPolymarket: 'Trade on Polymarket',

    // Tooltip descriptions
    tooltips: {
      totalOpenInterest: 'Total open interest across all outcomes',
      volume24h: 'Total trading volume in the past 24 hours',
      turnoverRate: '24h volume / total OI, reflects market activity',
      activeTraders: 'Number of addresses trading in the past 24h',
      newTraders: 'Number of new addresses participating in the past 24h',
      avgSpread: 'Average bid-ask spread, reflects liquidity',
      volatility: 'Price volatility standard deviation',
      whaleConcentration: 'Whale holding ratio, reflects market concentration',
      liquidityConcentration: 'Market maker liquidity concentration',
      lateVolumeSpike: 'Abnormal trading volume near settlement',
      disputeRisk: 'Settlement dispute probability based on history',
      creditScore: 'Overall quality score for this event',

      price: 'Current price for this outcome',
      priceChange1h: 'Price change in the past hour',
      priceChange24h: 'Price change in the past 24 hours',
      outcomeVolume24h: '24h trading volume for this outcome',
      outcomeOI: 'Open interest for this outcome',
      legTurnoverRate: 'Turnover rate for this outcome',
      bidDepth: 'Order book bid depth (top 10 levels)',
      askDepth: 'Order book ask depth (top 10 levels)',
      depthSkew: 'Bid-ask depth difference, positive means strong bids',
      liquidityGap: 'Liquidity vacuum areas in the order book',
      liquidityWalls: 'Large order walls blocking liquidity',
      vwapDeviation: 'Deviation from volume-weighted average price',
      smartMoneyRatio: 'Participation ratio of professional traders',
      whaleRatio: 'Whale trading proportion for this outcome',
      manipulationRisk: 'Risk score for market manipulation',
      legConfidence: 'Data confidence score for this outcome',
    },

    tabs: {
      holders: 'Holders',
      topTraders: 'Top Traders',
      activity: 'Activity',
    },

    table: {
      address: 'Address',
      shares: 'Shares',
      value: 'Value',
      avgBuy: 'Avg Buy',
      avgSell: 'Avg Sell',
      realizedPnL: 'Realized P&L',
      unrealizedPnL: 'Unrealized P&L',
      time: 'Time',
      type: 'Type',
      price: 'Price',
      total: 'Total',
      txHash: 'Tx Hash',
    },
  },
  orderBook: {
    latestPrice: 'Latest Price',
    spread: 'Spread',
  },
  stats: {
    volume24h: '24h Volume',
    openInterest: 'Open Interest',
    bidDepth: 'Bid Depth',
    askDepth: 'Ask Depth',
    depthSkew: 'Depth Skew',
    priceChange24h: '24h Change',
    yesPrice: 'Yes Price',
    noPrice: 'No Price',
  },
  tabs: {
    activity: 'Activity',
    holders: 'Holders',
    traders: 'Top Traders',
  },
  table: {
    address: 'Address',
    shares: 'Shares',
    value: 'Value',
    avgBuyPrice: 'Avg Buy Price',
    avgSellPrice: 'Avg Sell Price',
    realizedPnl: 'Realized P&L',
    realizedRoi: 'Realized ROI',
    unrealizedPnl: 'Unrealized P&L',
    unrealizedRoi: 'Unrealized ROI',
    time: 'Time',
    type: 'Type',
    price: 'Price',
    total: 'Total',
    txHash: 'Tx Hash',
    buy: 'Buy',
    sell: 'Sell',
    yes: 'Yes',
    no: 'No',
    eventName: 'Event Name',
    endDate: 'End Date',
    countdown: 'Countdown',
    firstTrade: 'First Trade',
    status: 'Status',
    buyCount: 'Buy Count',
    sellCount: 'Sell Count',
    active: 'Active',
    closed: 'Closed',
    settled: 'Settled',
    holdingDays: 'Holding Days',
    days: 'days',
  },
  user: {
    profile: 'User Profile',
    totalProfit: 'Total P&L',
    totalVolume: 'Total Volume',
    activePositions: 'Active Positions',
    winRate: 'Win Rate',
    profitChart: 'P&L Trend',
    radarChart: 'Trading Ability Analysis',
    positions: 'Positions',
    history: 'History',
    analytics: 'Analytics',
    profitability: 'Profitability',
    activeness: 'Activeness',
    diversification: 'Diversification',
    riskManagement: 'Risk Management',
    timing: 'Timing',
    consistency: 'Consistency',
    notFound: 'User Not Found',
    notFoundDesc: 'The user profile you are looking for does not exist',
    usdcBalance: 'USDC Balance',
    pnl: 'P&L',
    categoryAnalysis: 'Category Analysis',
    behaviorAnalysis: 'Behavior Analysis',
    riskPreference: 'Risk Preference',
    beliefAnalysis: 'Belief Preference',
    smartMoney: 'Smart Money',
    trendFollower: 'Trend Follower',
    contrarian: 'Contrarian',
    noiseTrader: 'Noise Trader',
    crypto: 'Crypto',
    politics: 'Politics',
    sports: 'Sports',
    entertainment: 'Entertainment',
    finance: 'Finance',
    highRisk: 'High Risk',
    mediumRisk: 'Medium Risk',
    lowRisk: 'Low Risk',
    conservative: 'Conservative',
    longTerm: 'Long Term',
    shortTerm: 'Short Term',
    momentum: 'Momentum',
    valueInvesting: 'Value',
    holdings: 'Holdings',
    tradeHistory: 'Trade History',
    activityLog: 'Activity Log',
    aiSummary: 'AI Summary',
    aiDescription: 'This address exhibits typical smart money characteristics, excelling at entering market trends early. Trading behavior leans towards high-risk high-reward strategies, primarily active in cryptocurrency and politics prediction markets. Short holding periods, classified as a short-term trader with strong market sensitivity and execution. Overall risk appetite is aggressive, but profitability is outstanding.',
    pnlDistribution: 'P&L Distribution',
    marketsParticipated: 'Markets Participated',
    totalTrades: 'Total Trades',
    totalVolumeStat: 'Total Volume',
    avgTradePrice: 'Avg Trade Price',
    avgHoldingTime: 'Avg Holding Time',
    maxProfit: 'Max Single Profit',
    maxLoss: 'Max Single Loss',
    minutesAgo: 'minutes ago',
  },
  timeRange: {
    '1d': '1D',
    '1w': '1W',
    '1m': '1M',
    '3m': '3M',
    '1y': '1Y',
    all: 'All',
  },
  trending: {
    title: 'Trending Markets',
    description: 'Real-time prediction market data from Polymarket',
    markets: 'markets',
    category: 'Category',
    event: 'Event',
    yes: 'Yes',
    no: 'No',
    oiChange: 'OI Change',
    change1h: '1H',
    change24h: '24H',
    endsAt: 'Ends at',
    loadingMarkets: 'Loading markets...',
    loadError: 'Failed to load markets',
    unknownError: 'Unknown error',
    noMarketsFound: 'No markets found in this category',
  },
  search: {
    searchResults: 'Search Results',
    resultsFor: 'Search results for',
    enterKeyword: 'Enter search keywords',
    events: 'Events',
    searching: 'Searching...',
    results: 'results',
    noEventsFound: 'No events found matching',
    matching: '',
    users: 'Users',
    noUsersFound: 'No users found',
    balance: 'Balance',
    roi: 'ROI',
    tip: 'Tip:',
    tipMessage: 'Enter a wallet address starting with "0x" to search for users',
    startSearching: 'Start Searching',
    searchDescription: 'Use the search bar above to find prediction markets or user profiles. You can search by event name, keywords, or wallet address.',
  },
  leaderboard: {
    title: 'Leaderboard',
    subtitle: 'Top traders ranked by ROI and trading performance',
    rank: 'Rank',
    address: 'Address',
    balance: 'Balance',
    portfolioValue: 'Portfolio Value',
    roi7d: '7d ROI',
    roi30d: '30d ROI',
    roiTotal: 'Total ROI',
    winRate: 'Win Rate',
    buyCount: 'Buy Count',
    sellCount: 'Sell Count',
  },
  dashboard: {
    title: 'Platform Dashboard',
    subtitle: 'View key metrics and trends across prediction markets',
    platform: {
      all: 'All Platforms',
      polymarket: 'Polymarket',
      kalshi: 'Kalshi',
      manifold: 'Manifold',
    },
    kpi: {
      totalVolume: 'Total Volume',
      volume24h: '24h Volume',
      totalUsers: 'Total Users',
      activeUsers: 'Active Users',
      totalMarkets: 'Total Markets',
      activeMarkets: 'Active Markets',
    },
    charts: {
      volumeTrend: 'Trading Volume Trend',
      userGrowth: 'User Growth',
      eventStatus: 'Event Status Distribution',
      categoryDistribution: 'Category Distribution',
      tradingHeatmap: 'Trading Heatmap',
      topMarkets: 'Top Markets',
      avgReturnTrend: 'Average Return Trend',
      newMarketsTrend: 'New Markets Trend',
      liquidityDistribution: 'Liquidity Distribution',
      volumeByCategory: 'Volume by Category',
    },
  },
}
